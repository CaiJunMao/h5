<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>淘宝购物车页面</title>
    <link href="css/myCart.css" type="text/css" rel="stylesheet" />
</head>
<body>
<div id="header"><img src="images/taobao_logo.gif" alt="logo" /></div>
<div id="nav">您的位置：<a href="#">首页</a> &gt; <a href="#">我的淘宝</a> &gt; 我的购物车</div>
<div id="navlist">
    <ul>
        <li class="navlist_red_left"></li>
        <li class="navlist_red">1. 查看购物车</li>
        <li class="navlist_red_arrow"></li>
        <li class="navlist_gray">2. 确认订单信息</li>
        <li class="navlist_gray_arrow"></li>
        <li class="navlist_gray">3. 付款到支付宝</li>
        <li class="navlist_gray_arrow"></li>
        <li class="navlist_gray">4. 确认收货</li>
        <li class="navlist_gray_arrow"></li>
        <li class="navlist_gray">5. 评价</li>
        <li class="navlist_gray_right"></li>
    </ul>
</div>

<div id="content">
	<form action="" method="post" name="myform">
    	<table width="100%" border="0" cellspacing="0" cellpadding="0" id="shopping">        
            <tr>
                <td class="title_1"><input id="allCheckBox" type="checkbox" value=""/>全选</td>
                <td class="title_2" colspan="2">店铺宝贝</td>
                <td class="title_3">获积分</td>
                <td class="title_4">单价（元）</td>
                <td class="title_5">数量</td>
                <td class="title_6">小计（元）</td>
                <td class="title_7">操作</td>
            </tr>
            <tr>
                <td colspan="8" class="line"></td>
            </tr>
            <tr>
                <td colspan="8" class="shopInfo">店铺：<a href="#">纤巧百媚时尚鞋坊</a>    卖家：<a href="#">纤巧百媚</a> <img src="images/taobao_relation.jpg" alt="relation" /></td>
            </tr>
            <tr id="product1">
                <td class="cart_td_1"><input name="cartCheckBox" type="checkbox" value="product1"/></td>
                <td class="cart_td_2"><img src="images/taobao_cart_01.jpg" alt="shopping"/></td>
                <td class="cart_td_3"><a href="#">日韩流行风时尚美眉最爱独特米字拼图金属坡跟公主靴子黑色</a><br />
                    颜色：棕色 尺码：37<br />
                    保障：<img src="images/taobao_icon_01.jpg" alt="icon" /></td>
                <td class="cart_td_4">5</td>
                <td class="cart_td_5">138.00</td>
                <td class="cart_td_6"><img src="images/taobao_minus.jpg" alt="minus" class="hand"/> <input id="num_1" type="text"  value="1" class="num_input" readonly="readonly"/> <img src="images/taobao_adding.jpg" alt="add" class="hand"/></td>
                <td class="cart_td_7"></td>
                <td class="cart_td_8"><a href="javascript:void(0);">删除</a></td>
            </tr>

            <tr>
                <td colspan="8" class="shopInfo">店铺：<a href="#">香港我的美丽日记</a>    卖家：<a href="#">lokemick2009</a> <img src="images/taobao_relation.jpg" alt="relation" /></td>
            </tr>
            <tr id="product2">
                <td class="cart_td_1"><input name="cartCheckBox" type="checkbox" value="product2" /></td>
                <td class="cart_td_2"><img src="images/taobao_cart_02.jpg" alt="shopping"/></td>
                <td class="cart_td_3"><a href="#">chanel/香奈尔/香奈尔炫亮魅力唇膏3.5g</a><br />
                    保障：<img src="images/taobao_icon_01.jpg" alt="icon" /> <img src="images/taobao_icon_02.jpg" alt="icon" /></td>
                <td class="cart_td_4">12</td>
                <td class="cart_td_5">265.00</td>
                <td class="cart_td_6"><img src="images/taobao_minus.jpg" alt="minus" class="hand"/> <input id="num_2" type="text"  value="1" class="num_input" readonly="readonly"/> <img src="images/taobao_adding.jpg" alt="add" class="hand"/></td>
                <td class="cart_td_7"></td>
                <td class="cart_td_8"><a href="javascript:void(0);">删除</a></td>
            </tr>

            <tr>
                <td colspan="8" class="shopInfo">店铺：<a href="#">实体经营</a>    卖家：<a href="#">林颜店铺</a> <img src="images/taobao_relation.jpg" alt="relation" /></td>
            </tr>
            <tr id="product3">
                <td class="cart_td_1"><input name="cartCheckBox" type="checkbox" value="product3"/></td>
                <td class="cart_td_2"><img src="images/taobao_cart_03.jpg" alt="shopping"/></td>
                <td class="cart_td_3"><a href="#">蝶妆海?蓝清滢粉底液10#（象牙白）</a><br />
                    保障：<img src="images/taobao_icon_01.jpg" alt="icon" /> <img src="images/taobao_icon_02.jpg" alt="icon" /></td>
                <td class="cart_td_4">3</td>
                <td class="cart_td_5">85.00</td>
                <td class="cart_td_6"><img src="images/taobao_minus.jpg" alt="minus" class="hand"/> <input id="num_3" type="text"  value="1" class="num_input" readonly="readonly"/> <img src="images/taobao_adding.jpg" alt="add" class="hand"/></td>
                <td class="cart_td_7"></td>
                <td class="cart_td_8"><a href="javascript:void(0);">删除</a></td>
            </tr>

            <tr>
                <td colspan="8" class="shopInfo">店铺：<a href="#">红豆豆的小屋</a>    卖家：<a href="#">taobao豆豆</a> <img src="images/taobao_relation.jpg" alt="relation" /></td>
            </tr>
            <tr id="product4">
                <td class="cart_td_1"><input name="cartCheckBox" type="checkbox" value="product4"/></td>
                <td class="cart_td_2"><img src="images/taobao_cart_04.jpg" alt="shopping"/></td>
                <td class="cart_td_3"><a href="#">相宜促销专供 大S推荐 最好用的LilyBell化妆棉</a><br />
                    保障：<img src="images/taobao_icon_01.jpg" alt="icon" /></td>
                <td class="cart_td_4">12</td>
                <td class="cart_td_5">12.00</td>
                <td class="cart_td_6"><img src="images/taobao_minus.jpg" alt="minus" class="hand"/> <input id="num_4" type="text"  value="2" class="num_input" readonly="readonly"/> <img src="images/taobao_adding.jpg" alt="add" class="hand"/></td>
                <td class="cart_td_7"></td>
                <td class="cart_td_8"><a href="javascript:void(0);">删除</a></td>
            </tr>

            <tr>
                <td  colspan="3"><a id="deleteAll" href="javascript:void(0);"><img src="images/taobao_del.jpg" alt="delete"/></a></td>
                <td colspan="5" class="shopend">商品总价（不含运费）：<label id="total" class="yellow"></label> 元<br />
                    可获积分 <label class="yellow" id="integral"></label> 点<br />
                    <input name=" " type="image" src="images/taobao_subtn.jpg" /></td>
            </tr>        
    	</table>
    </form>
</div>
</body>
<script type="text/javascript">
	var allCheckBox = $id("allCheckBox")
	//加减号
	var hands = $class("hand")
	// 单价
	var prices = $class("cart_td_5")
	// 积分
	var integrals = $class("cart_td_4")
	// 输入的数量
	var num_inputs = $class("num_input")
	// 小计
	var subtotals = $class("cart_td_7")
	// 总金额
	var total = $id("total")
	// 总积分
	var integral = $id("integral")
	// 获取到数组
	var inputs = document.getElementsByName("cartCheckBox")
	// 找到删除按钮数组
	var deletes = $class("cart_td_8")
	// 找到【删除】所选按钮
	var deleteAll = $id("deleteAll")
	// 全选和全不选的效果
	allCheckBox.onclick = function(){
		for (var i = 0; i < inputs.length; i ++) {
			inputs[i].checked = allCheckBox.checked
		}
	}
	// 监听【删除所选】按钮
	deleteAll.onclick = function(){
		// 遍历所有的input勾选框
		for (var i = 0; i < inputs.length; i++) {
			// 如果勾选框为true，即勾选了
			if(inputs[i].checked){
				console.log("🍎")
				// 那么就删除一项商品
				// 找到相应的节点，进行remove操作
				inputs[i].parentElement.parentElement.previousElementSibling.remove()
				inputs[i].parentElement.parentElement.remove()
				// 既然删除了一行，那么【总金额】和【总积分】需要重新计算
				totalAndInteralCalculate()
				// 重复确认
				i--
			}
		}
	}
	// 点击加减号可以增加和减少货物数量
	function addAndReduceNumber(){
		// 加减数量
		for (var i = 0; i < hands.length; i ++) {
			if(i % 2 === 1){ // 如果是加号
				// 点击加号
				hands[i].onclick = function(){
					this.previousElementSibling.value++
					// 实时计算【小计】的功能
					subtotalsCalculate()
					// 实时计算【总金额】和【总积分】的功能
					totalAndInteralCalculate()
				}
			}else{
				// 否则如果是减号
				hands[i].onclick = function(){
					// 如果之前的表单中的值为1
					if(this.nextElementSibling.value == 1){
						alert("宝贝数量必须大于0")
					}else{
						this.nextElementSibling.value--
						// 实时计算【小计】的功能
						subtotalsCalculate()
						// 实时计算【总金额】和【总积分】的功能
						totalAndInteralCalculate()
					}
				}
			}
		}
	}
	// 调用函数
	addAndReduceNumber()
	//===================
	// 计算小计的金额
	function subtotalsCalculate(){
		// 遍历每一个【单价】
		for (var i = 0; i < prices.length; i++) {
			subtotals[i].innerHTML = parseFloat(prices[i].innerHTML) *
			num_inputs[i].value
		}
	}
	// 执行【小计】函数
	subtotalsCalculate()
	// 实时计算【总金额】和【总积分】的函数
	function totalAndInteralCalculate(){
		var sum = 0
		var score = 0
		for (var i = 0; i < subtotals.length; i++) {
			// 如果前面的【勾选框】为勾选状态
			if(inputs[i].checked){
				// 计算总金额
				sum += parseFloat(subtotals[i].innerHTML)
				// 计算总积分
				score += parseFloat(integrals[i].innerHTML) * num_inputs[i].value
			}
		}
		// 给总金额赋值
		total.innerHTML = sum
		// 给总积分赋值
		integral.innerHTML = score
	}
	// 执行计算【总金额】和【总积分】的函数
	totalAndInteralCalculate()
	// 删除功能
	for (var i = 0;i < deletes.length;i ++) {
		deletes[i].firstElementChild.onclick = function(){
			// 找到相应的节点，进行remove操作
			this.parentElement.parentElement.previousElementSibling.remove()
			this.parentElement.parentElement.remove()
			// 既然删除了一行，那么【总金额】和【总积分】需要重新计算
			totalAndInteralCalculate()
		}
	}
	// 监听【勾选框】的状态变化
	for (var i = 0; i < inputs.length; i++) {
		// 如果监听到【勾选框】有变化
		inputs[i].onchange = function(){
			// 那么就重新计算【总金额】和【总积分】
			totalAndInteralCalculate()
		}
	}
	/**
	 * 用id获取到标签的方法
	 */
	function $id(id){
		return document.getElementById(id)
	}
	/**
	 * 用class获取到标签的方法
	 */
	function $class(className){
		return document.getElementsByClassName(className)
	}
</script>
</html>
